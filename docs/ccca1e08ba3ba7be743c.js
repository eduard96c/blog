import"./style.css";let edit=!1,all_articles=[];function $(e){return document.querySelector(e)}function addEvents(){document.querySelectorAll(".continue_reading").forEach((function(e){e.addEventListener("click",_handleContinueReading)})),document.querySelector("#create-article").addEventListener("click",openCreateFrom),document.querySelector(".close-modal").addEventListener("click",closeCreateForm),document.querySelector("#save-article").addEventListener("click",saveArticle),document.querySelectorAll(".delete-article").forEach((function(e){e.addEventListener("click",(function(){deleteArticle(e.closest(".article-container").dataset.id).then((e=>e.json())).then((e=>{console.log(e),e.success&&window.location.reload()}))}))})),document.querySelectorAll(".start-update").forEach((function(e){e.addEventListener("click",(function(){const t=e.closest(".article-container").dataset.id;openCreateFrom(),startUpdate(t)}))}))}function startUpdate(e){edit=e;const t=all_articles.find((t=>t.id==e));document.querySelector("#create-article-form");for(const e in t){const n=document.querySelector("#"+e);console.log(n),console.log(e),n&&(n.value=t[e])}}function deleteArticle(e){return console.warn(e),fetch("http://localhost:3000/articles-json/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})}function getArticles(){fetch("http://localhost:3000/articles-json").then((e=>e.json())).then((e=>{all_articles=e,displayArticles(all_articles),addEvents()}))}function createArticle(e){return fetch("http://localhost:3000/articles-json/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function updateArticle(e){return fetch("http://localhost:3000/articles-json/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function saveArticle(){event.preventDefault();const e=getFormValues();if(edit){const e=getFormValues();e.id=edit,updateArticle(e).then((e=>e.json())).then((t=>{t.success&&window.location.reload(),console.log(e)}))}else console.warn(e),createArticle(e).then((e=>e.json())).then((e=>{e.success&&window.location.reload()}))}function getFormValues(){const e={};return document.querySelectorAll("#create-article-form input,select,textarea").forEach((function(t){const n=t.id,c=t.value;e[n]=c})),e}function closeCreateForm(){document.querySelector("#article-modal").style.display="none"}function openCreateFrom(){document.querySelector("#article-modal").style.display="block"}function _handleContinueReading(){var e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block",console.log("Button clicked. Display style: "+e.style.display)}function getPreviewText(e){if(e)return e.slice(0,200)}function displayArticles(e){console.log(e);let t=document.querySelector("#blog-landing-articles");e.forEach((function(e){let n="";const c=getPreviewText(e.content);n=`<div class="article-container" data-id="${e.id}">\n    <div class="article-card">\n      <div class="article-card-image-holder">\n        <img height="165" src="/images/${e.image}">\n      </div>\n      <div class="article-card-content-holder">\n        <div class="article-card-content">\n          <div class="article-card-heading">\n            <h3>\n           ${e.title}\n            </h3>\n            <div class="article-card-heading-info">\n              <span>${e.date}</span>\n              <span>|</span>\n              <span>${e.category}</span>\n            </div>\n          </div>\n          <div class="article-card-text">\n            <p>\n             ${c}\n            </p>\n            <div class="card-button-holder">\n              <button type="button" class="continue_reading">\n                Continue Reading\n              </button>\n              <div class="article-control-buttons">\n                <span class="start-update control-btn" title="Update">üíæ</span>\n                <span class="delete-article control-btn" title="Delete">‚ùå</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>`,t.innerHTML+=n}))}getArticles();